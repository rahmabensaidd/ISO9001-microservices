<div class="row">
  <!-- Error message -->
  <div *ngIf="errorMessage" class="alert alert-danger">{{ errorMessage }}</div>

  <!-- List of evaluations -->
  <div class="col-lg-8">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title mb-4">List of Evaluations</h4>
        <div class="table-responsive">
          <table class="table table-striped">
            <thead>
            <tr>
              <th>Date</th>
              <th>Score</th>
              <th>Comment</th>
              <th>Training</th>
              <th>Actions</th>
            </tr>
            </thead>
            <tbody>
            <tr *ngFor="let evaluation of evaluations">
              <td>{{ evaluation.evalution_date }}</td>
              <td>{{ evaluation.performanceScore }}</td>
              <td>{{ evaluation.comment }}</td>
              <td>{{ evaluation.trainingName }}</td>
              <td>
                <button class="btn btn-primary btn-sm me-2" (click)="editEvaluation(evaluation)">
                  <i class="las la-edit"></i> Edit
                </button>
                <button class="btn btn-danger btn-sm" (click)="deleteEvaluation(evaluation.idEvaluation!)">
                  <i class="las la-trash-alt"></i> Delete
                </button>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

  <!-- Creation/editing form -->
  <div class="col-lg-4">
    <div class="card">
      <div class="card-body">
        <h4 class="card-title mb-4">{{ isEditing ? 'Edit an Evaluation' : 'Add an Evaluation' }}</h4>
        <form [formGroup]="evaluationForm" (ngSubmit)="isEditing ? updateEvaluation() : createEvaluation()">
          <div class="form-group mb-3">
            <label class="form-label">Evaluation Date</label>
            <input type="date" class="form-control" formControlName="evalution_date" />
            <div *ngIf="f['evalution_date'].touched && f['evalution_date'].errors" class="text-danger">
              <div *ngIf="f['evalution_date'].errors['required']">Please select a date.</div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label class="form-label">Performance Score</label>
            <input type="number" class="form-control" formControlName="performanceScore" />
            <div *ngIf="f['performanceScore'].touched && f['performanceScore'].errors" class="text-danger">
              <div *ngIf="f['performanceScore'].errors['required']">The score is required.</div>
              <div *ngIf="f['performanceScore'].errors['min']">The score must be at least 0.</div>
              <div *ngIf="f['performanceScore'].errors['max']">The score cannot exceed 100.</div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label class="form-label">Comment</label>
            <textarea class="form-control" formControlName="comment"></textarea>
            <div *ngIf="f['comment'].touched && f['comment'].errors" class="text-danger">
              <div *ngIf="f['comment'].errors['required']">The comment is required.</div>
              <div *ngIf="f['comment'].errors['minlength']">The comment must be at least 5 characters long.</div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label class="form-label">Training Name</label>
            <select class="form-control" formControlName="trainingName">
              <option value="" disabled>Select a training</option>
              <option *ngFor="let training of trainings" [value]="training.trainingName">
                {{ training.trainingName }}
              </option>
            </select>
            <div *ngIf="f['trainingName'].touched && f['trainingName'].errors" class="text-danger">
              <div *ngIf="f['trainingName'].errors['required']">The training name is required.</div>
            </div>
          </div>

          <button type="submit" class="btn btn-primary" [disabled]="evaluationForm.invalid">
            {{ isEditing ? 'Update' : 'Add' }}
          </button>
          <button type="button" class="btn btn-danger" (click)="resetForm()">Cancel</button>
        </form>
      </div>
    </div>
  </div>
</div>
